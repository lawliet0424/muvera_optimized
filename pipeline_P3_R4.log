[2025-10-17 15:41:27] START P=3 R=4
[pipeline] === STEP 1: Build FDE ===
2025-10-17 15:41:30,773 - INFO - Using device: cuda
2025-10-17 15:41:30,898 - INFO - Loading dataset from local path (BEIR): 'scidocs'...
2025-10-17 15:41:30,898 - INFO - Loading Corpus...
  0%|          | 0/25657 [00:00<?, ?it/s] 11%|█▏        | 2925/25657 [00:00<00:00, 29241.59it/s] 24%|██▍       | 6198/25657 [00:00<00:00, 31291.40it/s] 37%|███▋      | 9546/25657 [00:00<00:00, 32266.72it/s] 53%|█████▎    | 13483/25657 [00:00<00:00, 35038.75it/s] 70%|██████▉   | 17881/25657 [00:00<00:00, 38257.16it/s] 85%|████████▌ | 21912/25657 [00:00<00:00, 38953.62it/s]100%|██████████| 25657/25657 [00:00<00:00, 37113.10it/s]
2025-10-17 15:41:31,765 - INFO - Loaded 25657 TEST Documents.
2025-10-17 15:41:31,765 - INFO - Doc Example: {'text': 'An evolutionary recurrent network which automates the design of recurrent neural/fuzzy networks using a new evolutionary learning algorithm is proposed in this paper. This new evolutionary learning algorithm is based on a hybrid of genetic algorithm (GA) and particle swarm optimization (PSO), and is thus called HGAPSO. In HGAPSO, individuals in a new generation are created, not only by crossover and mutation operation as in GA, but also by PSO. The concept of elite strategy is adopted in HGAPSO, where the upper-half of the best-performing individuals in a population are regarded as elites. However, instead of being reproduced directly to the next generation, these elites are first enhanced. The group constituted by the elites is regarded as a swarm, and each elite corresponds to a particle within it. In this regard, the elites are enhanced by PSO, an operation which mimics the maturing phenomenon in nature. These enhanced elites constitute half of the population in the new generation, whereas the other half is generated by performing crossover and mutation operation on these enhanced elites. HGAPSO is applied to recurrent neural/fuzzy network design as follows. For recurrent neural network, a fully connected recurrent neural network is designed and applied to a temporal sequence production problem. For recurrent fuzzy network design, a Takagi-Sugeno-Kang-type recurrent fuzzy network is designed and applied to dynamic plant control. The performance of HGAPSO is compared to both GA and PSO in these recurrent networks design problems, demonstrating its superiority.', 'title': 'A hybrid of genetic algorithm and particle swarm optimization for recurrent network design'}
2025-10-17 15:41:31,765 - INFO - Loading Queries...
2025-10-17 15:41:31,806 - INFO - Loaded 1000 TEST Queries.
2025-10-17 15:41:31,806 - INFO - Query Example: A Direct Search Method to solve Economic Dispatch Problem with Valve-Point Effect
2025-10-17 15:41:31,806 - INFO - Dataset loaded: 25657 documents, 1000 queries.
2025-10-17 15:41:31,806 - INFO - Initializing retrieval models...
2025-10-17 15:41:33,351 - INFO - --- PHASE 1: INDEXING ---
2025-10-17 15:41:33,555 - INFO - [index] missing documents to encode: 25657 / 25657
2025-10-17 15:41:33,555 - INFO - [MEMORY] Before atomic batch processing: 999.8 MB (0.98 GB)
2025-10-17 15:41:33,555 - INFO - [index] encoding 25657 documents that are missing from precomputed files...
2025-10-17 15:41:33,555 - INFO - [ColbertFdeRetriever] Processing 25657 documents in atomic batches of 1000...
2025-10-17 15:41:33,556 - INFO - [Atomic Batch] Processing batch 1/26: docs 0-999
2025-10-17 15:41:33,562 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:09,  3.40it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:07,  4.14it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.44it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:06,  4.61it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.68it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.75it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.79it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.79it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.82it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.86it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.83it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.85it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.86it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.86it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.88it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.90it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.90it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.91it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.91it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.94it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.92it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.93it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.93it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.91it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.94it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.92it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.91it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.92it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.94it/s]
2025-10-17 15:41:40,181 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 15:41:40,181 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 15:41:40,181 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 15:41:40,608 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 15:41:41,015 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 15:41:41,421 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 15:41:41,809 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 15:41:41,809 - INFO - [FDE Batch] Batch generation completed in 1.628s
2025-10-17 15:41:41,809 - INFO - [FDE Batch] Output shape: (1000, 4096)
Traceback (most recent call last):
  File "/home/hyunji/Desktop/muvera_optimized/build_batch_fde.py", line 594, in <module>
    retriever.index(corpus)
  File "/home/hyunji/Desktop/muvera_optimized/build_batch_fde.py", line 400, in index
    batch_fde, partition_counts = generate_document_fde_batch(
ValueError: too many values to unpack (expected 2)
[2025-10-17 15:41:42] FAILED P=3 R=4
[2025-10-17 16:03:48] START P=3 R=4
[pipeline] === STEP 1: Build FDE ===
2025-10-17 16:03:51,266 - INFO - Using device: cuda
2025-10-17 16:03:51,433 - INFO - Loading dataset from local path (BEIR): 'scidocs'...
2025-10-17 16:03:51,433 - INFO - Loading Corpus...
  0%|          | 0/25657 [00:00<?, ?it/s] 11%|█▏        | 2924/25657 [00:00<00:00, 29172.56it/s] 24%|██▍       | 6203/25657 [00:00<00:00, 30951.87it/s] 38%|███▊      | 9676/25657 [00:00<00:00, 32662.98it/s] 53%|█████▎    | 13645/25657 [00:00<00:00, 35423.03it/s] 71%|███████   | 18093/25657 [00:00<00:00, 38677.63it/s] 86%|████████▌ | 22090/25657 [00:00<00:00, 39112.31it/s]100%|██████████| 25657/25657 [00:00<00:00, 37227.01it/s]
2025-10-17 16:03:52,295 - INFO - Loaded 25657 TEST Documents.
2025-10-17 16:03:52,295 - INFO - Doc Example: {'text': 'An evolutionary recurrent network which automates the design of recurrent neural/fuzzy networks using a new evolutionary learning algorithm is proposed in this paper. This new evolutionary learning algorithm is based on a hybrid of genetic algorithm (GA) and particle swarm optimization (PSO), and is thus called HGAPSO. In HGAPSO, individuals in a new generation are created, not only by crossover and mutation operation as in GA, but also by PSO. The concept of elite strategy is adopted in HGAPSO, where the upper-half of the best-performing individuals in a population are regarded as elites. However, instead of being reproduced directly to the next generation, these elites are first enhanced. The group constituted by the elites is regarded as a swarm, and each elite corresponds to a particle within it. In this regard, the elites are enhanced by PSO, an operation which mimics the maturing phenomenon in nature. These enhanced elites constitute half of the population in the new generation, whereas the other half is generated by performing crossover and mutation operation on these enhanced elites. HGAPSO is applied to recurrent neural/fuzzy network design as follows. For recurrent neural network, a fully connected recurrent neural network is designed and applied to a temporal sequence production problem. For recurrent fuzzy network design, a Takagi-Sugeno-Kang-type recurrent fuzzy network is designed and applied to dynamic plant control. The performance of HGAPSO is compared to both GA and PSO in these recurrent networks design problems, demonstrating its superiority.', 'title': 'A hybrid of genetic algorithm and particle swarm optimization for recurrent network design'}
2025-10-17 16:03:52,296 - INFO - Loading Queries...
2025-10-17 16:03:52,335 - INFO - Loaded 1000 TEST Queries.
2025-10-17 16:03:52,335 - INFO - Query Example: A Direct Search Method to solve Economic Dispatch Problem with Valve-Point Effect
2025-10-17 16:03:52,336 - INFO - Dataset loaded: 25657 documents, 1000 queries.
2025-10-17 16:03:52,336 - INFO - Initializing retrieval models...
2025-10-17 16:03:53,939 - INFO - --- PHASE 1: INDEXING ---
2025-10-17 16:03:54,138 - INFO - [index] missing documents to encode: 25657 / 25657
2025-10-17 16:03:54,138 - INFO - [MEMORY] Before atomic batch processing: 999.3 MB (0.98 GB)
2025-10-17 16:03:54,138 - INFO - [index] encoding 25657 documents that are missing from precomputed files...
2025-10-17 16:03:54,138 - INFO - [ColbertFdeRetriever] Processing 25657 documents in atomic batches of 1000...
2025-10-17 16:03:54,138 - INFO - [Atomic Batch] Processing batch 1/26: docs 0-999
2025-10-17 16:03:54,145 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:09,  3.34it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:07,  4.09it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.31it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:06,  4.54it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.67it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.77it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.81it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.82it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.84it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.87it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.88it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.88it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.87it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.88it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.90it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.91it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.92it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.93it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.93it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.94it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.94it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.95it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.95it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.95it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.94it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.95it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.96it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.93it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.92it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.93it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.95it/s]
2025-10-17 16:04:00,741 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:04:00,741 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:04:00,741 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:04:01,131 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:04:01,509 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:04:01,891 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:04:02,266 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:04:02,266 - INFO - [FDE Batch] Batch generation completed in 1.525s
2025-10-17 16:04:02,266 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:04:02,266 - INFO - [FDE Batch] Partition counter keys: 1000 documents
Traceback (most recent call last):
  File "/home/hyunji/Desktop/muvera_optimized/build_batch_fde.py", line 598, in <module>
    retriever.index(corpus)
  File "/home/hyunji/Desktop/muvera_optimized/build_batch_fde.py", line 416, in index
    f.write(f"{doc_idx},{rep_num},{partition_idx},{count}\n")
ValueError: I/O operation on closed file.
[2025-10-17 16:04:02] FAILED P=3 R=4
[2025-10-17 16:05:36] START P=3 R=4
[pipeline] === STEP 1: Build FDE ===
2025-10-17 16:05:40,247 - INFO - Using device: cuda
2025-10-17 16:05:40,364 - INFO - Loading dataset from local path (BEIR): 'scidocs'...
2025-10-17 16:05:40,364 - INFO - Loading Corpus...
  0%|          | 0/25657 [00:00<?, ?it/s] 10%|█         | 2577/25657 [00:00<00:00, 25758.05it/s] 21%|██▏       | 5471/25657 [00:00<00:00, 27564.24it/s] 34%|███▍      | 8697/25657 [00:00<00:00, 29703.94it/s] 48%|████▊     | 12325/25657 [00:00<00:00, 32237.88it/s] 65%|██████▍   | 16549/25657 [00:00<00:00, 35838.01it/s] 81%|████████  | 20727/25657 [00:00<00:00, 37853.91it/s] 96%|█████████▋| 24739/25657 [00:00<00:00, 38572.49it/s]100%|██████████| 25657/25657 [00:00<00:00, 34969.43it/s]
2025-10-17 16:05:41,291 - INFO - Loaded 25657 TEST Documents.
2025-10-17 16:05:41,291 - INFO - Doc Example: {'text': 'An evolutionary recurrent network which automates the design of recurrent neural/fuzzy networks using a new evolutionary learning algorithm is proposed in this paper. This new evolutionary learning algorithm is based on a hybrid of genetic algorithm (GA) and particle swarm optimization (PSO), and is thus called HGAPSO. In HGAPSO, individuals in a new generation are created, not only by crossover and mutation operation as in GA, but also by PSO. The concept of elite strategy is adopted in HGAPSO, where the upper-half of the best-performing individuals in a population are regarded as elites. However, instead of being reproduced directly to the next generation, these elites are first enhanced. The group constituted by the elites is regarded as a swarm, and each elite corresponds to a particle within it. In this regard, the elites are enhanced by PSO, an operation which mimics the maturing phenomenon in nature. These enhanced elites constitute half of the population in the new generation, whereas the other half is generated by performing crossover and mutation operation on these enhanced elites. HGAPSO is applied to recurrent neural/fuzzy network design as follows. For recurrent neural network, a fully connected recurrent neural network is designed and applied to a temporal sequence production problem. For recurrent fuzzy network design, a Takagi-Sugeno-Kang-type recurrent fuzzy network is designed and applied to dynamic plant control. The performance of HGAPSO is compared to both GA and PSO in these recurrent networks design problems, demonstrating its superiority.', 'title': 'A hybrid of genetic algorithm and particle swarm optimization for recurrent network design'}
2025-10-17 16:05:41,291 - INFO - Loading Queries...
2025-10-17 16:05:41,334 - INFO - Loaded 1000 TEST Queries.
2025-10-17 16:05:41,334 - INFO - Query Example: A Direct Search Method to solve Economic Dispatch Problem with Valve-Point Effect
2025-10-17 16:05:41,334 - INFO - Dataset loaded: 25657 documents, 1000 queries.
2025-10-17 16:05:41,334 - INFO - Initializing retrieval models...
2025-10-17 16:05:43,036 - INFO - --- PHASE 1: INDEXING ---
2025-10-17 16:05:43,243 - INFO - [index] missing documents to encode: 25657 / 25657
2025-10-17 16:05:43,243 - INFO - [MEMORY] Before atomic batch processing: 1000.2 MB (0.98 GB)
2025-10-17 16:05:43,243 - INFO - [index] encoding 25657 documents that are missing from precomputed files...
2025-10-17 16:05:43,243 - INFO - [ColbertFdeRetriever] Processing 25657 documents in atomic batches of 1000...
2025-10-17 16:05:43,243 - INFO - [Atomic Batch] Processing batch 1/26: docs 0-999
2025-10-17 16:05:43,250 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:09,  3.29it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:07,  4.00it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.30it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:06,  4.42it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:06,  4.39it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.55it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.63it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.63it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:02<00:04,  4.64it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.67it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.70it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.71it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:04,  4.74it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:03<00:03,  4.71it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.70it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.70it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.72it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.77it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:04<00:02,  4.76it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.72it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.72it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.72it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.78it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.81it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.77it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.75it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.73it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:06<00:00,  4.76it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.79it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.77it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.74it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.77it/s]
2025-10-17 16:05:50,100 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:05:50,101 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:05:50,101 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:05:50,539 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:05:50,967 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:05:51,405 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:05:51,812 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:05:51,812 - INFO - [FDE Batch] Batch generation completed in 1.711s
2025-10-17 16:05:51,812 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:05:51,812 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:05:52,477 - INFO - [MEMORY] After atomic batch 1: 1376.0 MB (1.34 GB)
2025-10-17 16:05:52,477 - INFO - [Atomic Batch] Processing batch 2/26: docs 1000-1999
2025-10-17 16:05:52,484 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.86it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.87it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.85it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.79it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.75it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.72it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.69it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.67it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.69it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.69it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.70it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.68it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:04,  4.66it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.68it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.69it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.69it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.70it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.71it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:04<00:02,  4.69it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.67it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.68it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.69it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.70it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.69it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.65it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.65it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.65it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.67it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.65it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.65it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.63it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.80it/s]
2025-10-17 16:05:59,304 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:05:59,304 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:05:59,304 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:05:59,767 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:06:00,175 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:06:00,606 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:06:01,059 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:06:01,059 - INFO - [FDE Batch] Batch generation completed in 1.755s
2025-10-17 16:06:01,059 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:06:01,059 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:06:01,759 - INFO - [MEMORY] After atomic batch 2: 1413.9 MB (1.38 GB)
2025-10-17 16:06:01,759 - INFO - [Atomic Batch] Processing batch 3/26: docs 2000-2999
2025-10-17 16:06:01,773 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:07,  4.31it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.51it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.62it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.68it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.69it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.70it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.73it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.77it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.80it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.79it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.76it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.77it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:04,  4.73it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.72it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.73it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.73it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.72it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.72it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:04<00:02,  4.71it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.70it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.71it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.69it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.71it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.68it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.67it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.68it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.66it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.66it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.66it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.68it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.66it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.81it/s]
2025-10-17 16:06:08,589 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:06:08,589 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:06:08,590 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:06:09,071 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:06:09,579 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:06:10,153 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:06:10,751 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:06:10,751 - INFO - [FDE Batch] Batch generation completed in 2.162s
2025-10-17 16:06:10,751 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:06:10,751 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:06:11,481 - INFO - [MEMORY] After atomic batch 3: 1429.5 MB (1.40 GB)
2025-10-17 16:06:11,481 - INFO - [Atomic Batch] Processing batch 4/26: docs 3000-3999
2025-10-17 16:06:11,489 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.72it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.70it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.64it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:06,  4.57it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.59it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.61it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.68it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.74it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:05,  4.44it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.53it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.56it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.61it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:04,  4.60it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:03<00:03,  4.63it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.63it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.59it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.68it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.74it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:04<00:02,  4.73it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.73it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.72it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.72it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.71it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.71it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.71it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.76it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.75it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:06<00:00,  4.74it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.77it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.76it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.75it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.79it/s]
2025-10-17 16:06:18,310 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:06:18,311 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:06:18,311 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:06:18,799 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:06:19,217 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:06:19,653 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:06:20,079 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:06:20,079 - INFO - [FDE Batch] Batch generation completed in 1.768s
2025-10-17 16:06:20,079 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:06:20,079 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:06:20,794 - INFO - [MEMORY] After atomic batch 4: 1417.8 MB (1.38 GB)
2025-10-17 16:06:20,794 - INFO - [Atomic Batch] Processing batch 5/26: docs 4000-4999
2025-10-17 16:06:20,800 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.96it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.87it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.89it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.90it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.81it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.77it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.76it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.75it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.74it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.77it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.81it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.78it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.76it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.76it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.78it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.72it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.75it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.73it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.72it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.72it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.71it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.74it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.81it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.80it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.77it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.75it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.73it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.71it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.75it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.70it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.71it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.87it/s]
2025-10-17 16:06:27,524 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:06:27,525 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:06:27,525 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:06:27,951 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:06:28,375 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:06:28,800 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:06:29,197 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:06:29,197 - INFO - [FDE Batch] Batch generation completed in 1.673s
2025-10-17 16:06:29,197 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:06:29,197 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:06:29,852 - INFO - [MEMORY] After atomic batch 5: 1433.4 MB (1.40 GB)
2025-10-17 16:06:29,852 - INFO - [Atomic Batch] Processing batch 6/26: docs 5000-5999
2025-10-17 16:06:29,859 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.85it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.81it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.80it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.81it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.83it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.84it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.82it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.78it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.80it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.76it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.76it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.77it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.80it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.82it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.78it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.78it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.79it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.80it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.80it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.78it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.75it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.75it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.75it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.73it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.70it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.70it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.71it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.70it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.67it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.88it/s]
2025-10-17 16:06:36,566 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:06:36,566 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:06:36,566 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:06:37,014 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:06:37,417 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:06:37,805 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:06:38,185 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:06:38,185 - INFO - [FDE Batch] Batch generation completed in 1.620s
2025-10-17 16:06:38,185 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:06:38,185 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:06:38,751 - INFO - [MEMORY] After atomic batch 6: 1449.0 MB (1.42 GB)
2025-10-17 16:06:38,751 - INFO - [Atomic Batch] Processing batch 7/26: docs 6000-6999
2025-10-17 16:06:38,758 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.91it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.69it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.68it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.70it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.70it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.78it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.81it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.75it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.75it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.80it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.80it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.79it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.82it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.85it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.85it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.86it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.79it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.76it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.62it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.70it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.71it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.69it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.72it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.70it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.71it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.72it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.69it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.73it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.74it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.76it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.86it/s]
2025-10-17 16:06:45,481 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:06:45,481 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:06:45,482 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:06:45,909 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:06:46,333 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:06:46,753 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:06:47,148 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:06:47,148 - INFO - [FDE Batch] Batch generation completed in 1.668s
2025-10-17 16:06:47,148 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:06:47,148 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:06:47,728 - INFO - [MEMORY] After atomic batch 7: 1464.6 MB (1.43 GB)
2025-10-17 16:06:47,728 - INFO - [Atomic Batch] Processing batch 8/26: docs 7000-7999
2025-10-17 16:06:47,734 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.90it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.87it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.89it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.87it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.83it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.81it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.82it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.84it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.79it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.77it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.71it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.77it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:04,  4.50it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.63it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.71it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.78it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.89it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.89it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.91it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.90it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.91it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.90it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.90it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.91it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.91it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.93it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.91it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.92it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.92it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.91it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.96it/s]
2025-10-17 16:06:54,317 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:06:54,317 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:06:54,317 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:06:54,736 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:06:55,120 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:06:55,507 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:06:55,886 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:06:55,886 - INFO - [FDE Batch] Batch generation completed in 1.569s
2025-10-17 16:06:55,886 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:06:55,886 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:06:56,449 - INFO - [MEMORY] After atomic batch 8: 1507.6 MB (1.47 GB)
2025-10-17 16:06:56,449 - INFO - [Atomic Batch] Processing batch 9/26: docs 8000-8999
2025-10-17 16:06:56,456 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.91it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.93it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.94it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.94it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.94it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.88it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.83it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.83it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.83it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.83it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.72it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.77it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.77it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.77it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.77it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.75it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.74it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.72it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.73it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.78it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.81it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.82it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.79it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.80it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.81it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.81it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.80it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.78it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.78it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.79it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.91it/s]
2025-10-17 16:07:03,101 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:07:03,101 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:07:03,102 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:07:03,502 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:07:03,891 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:07:04,275 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:07:04,665 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:07:04,665 - INFO - [FDE Batch] Batch generation completed in 1.564s
2025-10-17 16:07:04,665 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:07:04,665 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:07:05,249 - INFO - [MEMORY] After atomic batch 9: 1523.2 MB (1.49 GB)
2025-10-17 16:07:05,249 - INFO - [Atomic Batch] Processing batch 10/26: docs 9000-9999
2025-10-17 16:07:05,255 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.88it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.88it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.80it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.84it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.85it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.81it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.84it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.85it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.88it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.90it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.50it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.63it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:04,  4.70it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.74it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.78it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.86it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.88it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.89it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.91it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.91it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.92it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.91it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.90it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.93it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.92it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.94it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.94it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.93it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.95it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.97it/s]
2025-10-17 16:07:11,821 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:07:11,821 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:07:11,821 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:07:12,222 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:07:12,603 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:07:12,984 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:07:13,361 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:07:13,361 - INFO - [FDE Batch] Batch generation completed in 1.541s
2025-10-17 16:07:13,361 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:07:13,361 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:07:13,929 - INFO - [MEMORY] After atomic batch 10: 1541.7 MB (1.51 GB)
2025-10-17 16:07:13,929 - INFO - [Atomic Batch] Processing batch 11/26: docs 10000-10999
2025-10-17 16:07:13,936 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.85it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.84it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.87it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.88it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.91it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.93it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.91it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.91it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.90it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.91it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.93it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.95it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.92it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.92it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.93it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.91it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.91it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.93it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.90it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.93it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.93it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.89it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.90it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.89it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.90it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.89it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.91it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.94it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.92it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  5.03it/s]
2025-10-17 16:07:20,431 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:07:20,432 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:07:20,432 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:07:20,815 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:07:21,194 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:07:21,578 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:07:21,969 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:07:21,969 - INFO - [FDE Batch] Batch generation completed in 1.537s
2025-10-17 16:07:21,969 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:07:21,969 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:07:22,524 - INFO - [MEMORY] After atomic batch 11: 1557.4 MB (1.52 GB)
2025-10-17 16:07:22,524 - INFO - [Atomic Batch] Processing batch 12/26: docs 11000-11999
2025-10-17 16:07:22,531 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.90it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.93it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.92it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.88it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.91it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.90it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.88it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.89it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.81it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.86it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.87it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.89it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.90it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.91it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.91it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.93it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.91it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.94it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.91it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.89it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.88it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.91it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.90it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.92it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.88it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.88it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.88it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  5.01it/s]
2025-10-17 16:07:29,046 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:07:29,046 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:07:29,047 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:07:29,453 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:07:29,859 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:07:30,250 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:07:30,646 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:07:30,646 - INFO - [FDE Batch] Batch generation completed in 1.599s
2025-10-17 16:07:30,646 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:07:30,646 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:07:31,221 - INFO - [MEMORY] After atomic batch 12: 1573.0 MB (1.54 GB)
2025-10-17 16:07:31,222 - INFO - [Atomic Batch] Processing batch 13/26: docs 12000-12999
2025-10-17 16:07:31,228 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.83it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.84it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.87it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.85it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.86it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.84it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.86it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.88it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.84it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.82it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.81it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.82it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.82it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.83it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.82it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.82it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.75it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.77it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.80it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.79it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.80it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.81it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.80it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.77it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.79it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.80it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.85it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.88it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.86it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.94it/s]
2025-10-17 16:07:37,838 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:07:37,838 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:07:37,839 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:07:38,225 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:07:38,603 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:07:38,991 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:07:39,369 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:07:39,369 - INFO - [FDE Batch] Batch generation completed in 1.531s
2025-10-17 16:07:39,369 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:07:39,369 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:07:40,005 - INFO - [MEMORY] After atomic batch 13: 1588.6 MB (1.55 GB)
2025-10-17 16:07:40,005 - INFO - [Atomic Batch] Processing batch 14/26: docs 13000-13999
2025-10-17 16:07:40,012 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.86it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.90it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.89it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.89it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.91it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.93it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.95it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.91it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.88it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.89it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.89it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.88it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.89it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.90it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.93it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.92it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.91it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.92it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.94it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.93it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.69it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.75it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.79it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.81it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.83it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.87it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.87it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.89it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.90it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  5.00it/s]
2025-10-17 16:07:46,705 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:07:46,705 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:07:46,706 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:07:47,110 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:07:47,510 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:07:47,897 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:07:48,275 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:07:48,275 - INFO - [FDE Batch] Batch generation completed in 1.570s
2025-10-17 16:07:48,275 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:07:48,275 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:07:48,843 - INFO - [MEMORY] After atomic batch 14: 1604.2 MB (1.57 GB)
2025-10-17 16:07:48,843 - INFO - [Atomic Batch] Processing batch 15/26: docs 14000-14999
2025-10-17 16:07:48,850 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.96it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.95it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.93it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.93it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.94it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.96it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.95it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.95it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.96it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.95it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.96it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.96it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.93it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.94it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.93it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.91it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.93it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.91it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.91it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.89it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.89it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.89it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.89it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.90it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.89it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.91it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.92it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.88it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.90it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.90it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.89it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  5.03it/s]
2025-10-17 16:07:55,339 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:07:55,340 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:07:55,340 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:07:55,734 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:07:56,149 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:07:56,534 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:07:56,919 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:07:56,919 - INFO - [FDE Batch] Batch generation completed in 1.580s
2025-10-17 16:07:56,919 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:07:56,919 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:07:57,479 - INFO - [MEMORY] After atomic batch 15: 1619.8 MB (1.58 GB)
2025-10-17 16:07:57,480 - INFO - [Atomic Batch] Processing batch 16/26: docs 15000-15999
2025-10-17 16:07:57,486 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.98it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.93it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.94it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.96it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.92it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.92it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.90it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.93it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.93it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.91it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.91it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.89it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.88it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.86it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.85it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.87it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.87it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.86it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.86it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.85it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.82it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.82it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.80it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.80it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.81it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.83it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.84it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.85it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.85it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.85it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.79it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.97it/s]
2025-10-17 16:08:04,059 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:08:04,059 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:08:04,060 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:08:04,463 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:08:04,867 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:08:05,267 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:08:05,656 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:08:05,656 - INFO - [FDE Batch] Batch generation completed in 1.597s
2025-10-17 16:08:05,656 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:08:05,656 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:08:06,241 - INFO - [MEMORY] After atomic batch 16: 1605.3 MB (1.57 GB)
2025-10-17 16:08:06,241 - INFO - [Atomic Batch] Processing batch 17/26: docs 16000-16999
2025-10-17 16:08:06,248 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.82it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.85it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.88it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.86it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.88it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.87it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.88it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.90it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.88it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.90it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.88it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.85it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.86it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.82it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.84it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.85it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.86it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.86it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.89it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.90it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.87it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.89it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.88it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.90it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.91it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.87it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.88it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.88it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.89it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.99it/s]
2025-10-17 16:08:12,800 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:08:12,801 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:08:12,801 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:08:13,199 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:08:13,592 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:08:13,994 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:08:14,384 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:08:14,384 - INFO - [FDE Batch] Batch generation completed in 1.583s
2025-10-17 16:08:14,384 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:08:14,384 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:08:14,993 - INFO - [MEMORY] After atomic batch 17: 1620.9 MB (1.58 GB)
2025-10-17 16:08:14,993 - INFO - [Atomic Batch] Processing batch 18/26: docs 17000-17999
2025-10-17 16:08:14,999 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.96it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.91it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.92it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.94it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.95it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.90it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.91it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.89it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.92it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.93it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.92it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.92it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.92it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.92it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.88it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.83it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.85it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.88it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.92it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.91it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.91it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.92it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.93it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.92it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.90it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.87it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.86it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.89it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.84it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  5.01it/s]
2025-10-17 16:08:21,524 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:08:21,524 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:08:21,524 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:08:21,962 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:08:22,358 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:08:22,762 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:08:23,145 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:08:23,145 - INFO - [FDE Batch] Batch generation completed in 1.621s
2025-10-17 16:08:23,145 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:08:23,145 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:08:23,713 - INFO - [MEMORY] After atomic batch 18: 1636.5 MB (1.60 GB)
2025-10-17 16:08:23,713 - INFO - [Atomic Batch] Processing batch 19/26: docs 18000-18999
2025-10-17 16:08:23,719 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.88it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.87it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.89it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.90it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.90it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.91it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.91it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.90it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.88it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.84it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.87it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.86it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.88it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.90it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.87it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.89it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.90it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.88it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.90it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.86it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.86it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.86it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.87it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.87it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.88it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.88it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.89it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:05<00:00,  4.87it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.83it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.83it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.99it/s]
2025-10-17 16:08:30,268 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:08:30,268 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:08:30,269 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:08:30,679 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:08:31,081 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:08:31,485 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:08:31,875 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:08:31,875 - INFO - [FDE Batch] Batch generation completed in 1.607s
2025-10-17 16:08:31,875 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:08:31,875 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:08:32,433 - INFO - [MEMORY] After atomic batch 19: 1681.8 MB (1.64 GB)
2025-10-17 16:08:32,433 - INFO - [Atomic Batch] Processing batch 20/26: docs 19000-19999
2025-10-17 16:08:32,440 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.53it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.70it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.71it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.77it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.77it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.78it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.78it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:05,  4.80it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.81it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.82it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.82it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.83it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.84it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.85it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.82it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.82it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.83it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.82it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.85it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.85it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.88it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.87it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.88it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.88it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.89it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.88it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.85it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.81it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.75it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.93it/s]
2025-10-17 16:08:39,066 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:08:39,066 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:08:39,067 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:08:39,453 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:08:39,839 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:08:40,228 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:08:40,607 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:08:40,607 - INFO - [FDE Batch] Batch generation completed in 1.542s
2025-10-17 16:08:40,607 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:08:40,608 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:08:41,169 - INFO - [MEMORY] After atomic batch 20: 1697.4 MB (1.66 GB)
2025-10-17 16:08:41,169 - INFO - [Atomic Batch] Processing batch 21/26: docs 20000-20999
2025-10-17 16:08:41,176 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.63it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.78it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.83it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.83it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.88it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.90it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.89it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.90it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.89it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.84it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.84it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.84it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.85it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.82it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.81it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.75it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.77it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.74it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.70it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.71it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.74it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.73it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.74it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.74it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.73it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.72it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.67it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.70it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.90it/s]
2025-10-17 16:08:47,838 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:08:47,838 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:08:47,839 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:08:48,222 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:08:48,598 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:08:48,975 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:08:49,365 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:08:49,365 - INFO - [FDE Batch] Batch generation completed in 1.527s
2025-10-17 16:08:49,366 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:08:49,366 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:08:49,937 - INFO - [MEMORY] After atomic batch 21: 1713.0 MB (1.67 GB)
2025-10-17 16:08:49,937 - INFO - [Atomic Batch] Processing batch 22/26: docs 21000-21999
2025-10-17 16:08:49,943 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.82it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.88it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.87it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.86it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.85it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.89it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.91it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.90it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.91it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.90it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.89it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.90it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.93it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.88it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.88it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.89it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.87it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.86it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.86it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.88it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.89it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.90it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.84it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.76it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.71it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.67it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.65it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.63it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.61it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.60it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.58it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.91it/s]
2025-10-17 16:08:56,589 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:08:56,590 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:08:56,590 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:08:56,977 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:08:57,361 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:08:57,758 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:08:58,139 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:08:58,139 - INFO - [FDE Batch] Batch generation completed in 1.549s
2025-10-17 16:08:58,139 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:08:58,139 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:08:58,683 - INFO - [MEMORY] After atomic batch 22: 1728.6 MB (1.69 GB)
2025-10-17 16:08:58,683 - INFO - [Atomic Batch] Processing batch 23/26: docs 22000-22999
2025-10-17 16:08:58,689 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.69it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.82it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:06,  4.82it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.84it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.84it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.83it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.85it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.86it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.85it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.83it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.84it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.85it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.83it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.84it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.82it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.83it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.83it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.78it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.68it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.62it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.61it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.56it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.54it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.53it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.53it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.51it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.53it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.52it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.83it/s]
2025-10-17 16:09:05,455 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:09:05,455 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:09:05,456 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:09:05,866 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:09:06,273 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:09:06,666 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:09:07,061 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:09:07,061 - INFO - [FDE Batch] Batch generation completed in 1.606s
2025-10-17 16:09:07,061 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:09:07,061 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:09:07,629 - INFO - [MEMORY] After atomic batch 23: 1714.7 MB (1.67 GB)
2025-10-17 16:09:07,629 - INFO - [Atomic Batch] Processing batch 24/26: docs 23000-23999
2025-10-17 16:09:07,635 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.97it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.91it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.92it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.93it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.94it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.90it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.92it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.94it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.85it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.85it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.83it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.82it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.81it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.81it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.82it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.82it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.76it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.73it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.75it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.72it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.70it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.69it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:04<00:01,  4.69it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.71it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.69it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.69it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.68it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.68it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.67it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.66it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.88it/s]
2025-10-17 16:09:14,322 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:09:14,322 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:09:14,322 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:09:14,708 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:09:15,096 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:09:15,477 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:09:15,856 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:09:15,856 - INFO - [FDE Batch] Batch generation completed in 1.534s
2025-10-17 16:09:15,856 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:09:15,856 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:09:16,417 - INFO - [MEMORY] After atomic batch 24: 1730.3 MB (1.69 GB)
2025-10-17 16:09:16,417 - INFO - [Atomic Batch] Processing batch 25/26: docs 24000-24999
2025-10-17 16:09:16,424 - INFO - [Atomic Batch] Encoding 1000 missing documents...
ColBERT documents embeddings:   0%|          | 0/32 [00:00<?, ?it/s]ColBERT documents embeddings:   3%|▎         | 1/32 [00:00<00:06,  4.86it/s]ColBERT documents embeddings:   6%|▋         | 2/32 [00:00<00:06,  4.90it/s]ColBERT documents embeddings:   9%|▉         | 3/32 [00:00<00:05,  4.94it/s]ColBERT documents embeddings:  12%|█▎        | 4/32 [00:00<00:05,  4.91it/s]ColBERT documents embeddings:  16%|█▌        | 5/32 [00:01<00:05,  4.92it/s]ColBERT documents embeddings:  19%|█▉        | 6/32 [00:01<00:05,  4.92it/s]ColBERT documents embeddings:  22%|██▏       | 7/32 [00:01<00:05,  4.92it/s]ColBERT documents embeddings:  25%|██▌       | 8/32 [00:01<00:04,  4.89it/s]ColBERT documents embeddings:  28%|██▊       | 9/32 [00:01<00:04,  4.88it/s]ColBERT documents embeddings:  31%|███▏      | 10/32 [00:02<00:04,  4.87it/s]ColBERT documents embeddings:  34%|███▍      | 11/32 [00:02<00:04,  4.89it/s]ColBERT documents embeddings:  38%|███▊      | 12/32 [00:02<00:04,  4.83it/s]ColBERT documents embeddings:  41%|████      | 13/32 [00:02<00:03,  4.75it/s]ColBERT documents embeddings:  44%|████▍     | 14/32 [00:02<00:03,  4.74it/s]ColBERT documents embeddings:  47%|████▋     | 15/32 [00:03<00:03,  4.72it/s]ColBERT documents embeddings:  50%|█████     | 16/32 [00:03<00:03,  4.74it/s]ColBERT documents embeddings:  53%|█████▎    | 17/32 [00:03<00:03,  4.69it/s]ColBERT documents embeddings:  56%|█████▋    | 18/32 [00:03<00:02,  4.71it/s]ColBERT documents embeddings:  59%|█████▉    | 19/32 [00:03<00:02,  4.71it/s]ColBERT documents embeddings:  62%|██████▎   | 20/32 [00:04<00:02,  4.74it/s]ColBERT documents embeddings:  66%|██████▌   | 21/32 [00:04<00:02,  4.71it/s]ColBERT documents embeddings:  69%|██████▉   | 22/32 [00:04<00:02,  4.70it/s]ColBERT documents embeddings:  72%|███████▏  | 23/32 [00:04<00:01,  4.73it/s]ColBERT documents embeddings:  75%|███████▌  | 24/32 [00:05<00:01,  4.73it/s]ColBERT documents embeddings:  78%|███████▊  | 25/32 [00:05<00:01,  4.73it/s]ColBERT documents embeddings:  81%|████████▏ | 26/32 [00:05<00:01,  4.69it/s]ColBERT documents embeddings:  84%|████████▍ | 27/32 [00:05<00:01,  4.70it/s]ColBERT documents embeddings:  88%|████████▊ | 28/32 [00:05<00:00,  4.72it/s]ColBERT documents embeddings:  91%|█████████ | 29/32 [00:06<00:00,  4.70it/s]ColBERT documents embeddings:  94%|█████████▍| 30/32 [00:06<00:00,  4.70it/s]ColBERT documents embeddings:  97%|█████████▋| 31/32 [00:06<00:00,  4.71it/s]ColBERT documents embeddings: 100%|██████████| 32/32 [00:06<00:00,  4.88it/s]
2025-10-17 16:09:23,108 - INFO - [Atomic Batch] Generating FDE for 1000 documents...
2025-10-17 16:09:23,108 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:09:23,108 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:09:23,533 - INFO - [FDE Batch] rep 0 doc 1000/1000 processed
2025-10-17 16:09:23,917 - INFO - [FDE Batch] rep 1 doc 1000/1000 processed
2025-10-17 16:09:24,295 - INFO - [FDE Batch] rep 2 doc 1000/1000 processed
2025-10-17 16:09:24,685 - INFO - [FDE Batch] rep 3 doc 1000/1000 processed
2025-10-17 16:09:24,685 - INFO - [FDE Batch] Batch generation completed in 1.577s
2025-10-17 16:09:24,685 - INFO - [FDE Batch] Output shape: (1000, 4096)
2025-10-17 16:09:24,685 - INFO - [FDE Batch] Partition counter keys: 1000 documents
2025-10-17 16:09:25,257 - INFO - [MEMORY] After atomic batch 25: 1773.7 MB (1.73 GB)
2025-10-17 16:09:25,257 - INFO - [Atomic Batch] Processing batch 26/26: docs 25000-25656
2025-10-17 16:09:25,261 - INFO - [Atomic Batch] Encoding 657 missing documents...
ColBERT documents embeddings:   0%|          | 0/21 [00:00<?, ?it/s]ColBERT documents embeddings:   5%|▍         | 1/21 [00:00<00:04,  4.89it/s]ColBERT documents embeddings:  10%|▉         | 2/21 [00:00<00:03,  4.93it/s]ColBERT documents embeddings:  14%|█▍        | 3/21 [00:00<00:03,  4.94it/s]ColBERT documents embeddings:  19%|█▉        | 4/21 [00:00<00:03,  4.96it/s]ColBERT documents embeddings:  24%|██▍       | 5/21 [00:01<00:03,  4.94it/s]ColBERT documents embeddings:  29%|██▊       | 6/21 [00:01<00:03,  4.92it/s]ColBERT documents embeddings:  33%|███▎      | 7/21 [00:01<00:02,  4.93it/s]ColBERT documents embeddings:  38%|███▊      | 8/21 [00:01<00:02,  4.93it/s]ColBERT documents embeddings:  43%|████▎     | 9/21 [00:01<00:02,  4.84it/s]ColBERT documents embeddings:  48%|████▊     | 10/21 [00:02<00:02,  4.81it/s]ColBERT documents embeddings:  52%|█████▏    | 11/21 [00:02<00:02,  4.76it/s]ColBERT documents embeddings:  57%|█████▋    | 12/21 [00:02<00:01,  4.77it/s]ColBERT documents embeddings:  62%|██████▏   | 13/21 [00:02<00:01,  4.78it/s]ColBERT documents embeddings:  67%|██████▋   | 14/21 [00:02<00:01,  4.72it/s]ColBERT documents embeddings:  71%|███████▏  | 15/21 [00:03<00:01,  4.70it/s]ColBERT documents embeddings:  76%|███████▌  | 16/21 [00:03<00:01,  4.71it/s]ColBERT documents embeddings:  81%|████████  | 17/21 [00:03<00:00,  4.68it/s]ColBERT documents embeddings:  86%|████████▌ | 18/21 [00:03<00:00,  4.64it/s]ColBERT documents embeddings:  90%|█████████ | 19/21 [00:03<00:00,  4.67it/s]ColBERT documents embeddings:  95%|█████████▌| 20/21 [00:04<00:00,  4.70it/s]ColBERT documents embeddings: 100%|██████████| 21/21 [00:04<00:00,  5.40it/s]ColBERT documents embeddings: 100%|██████████| 21/21 [00:04<00:00,  4.88it/s]
2025-10-17 16:09:29,648 - INFO - [Atomic Batch] Generating FDE for 657 documents...
2025-10-17 16:09:29,648 - INFO - [FDE Batch] Using identity projection (dim=128)
2025-10-17 16:09:29,648 - INFO - [FDE Batch] Processing repetition 1/4
2025-10-17 16:09:30,690 - INFO - [FDE Batch] Batch generation completed in 1.042s
2025-10-17 16:09:30,690 - INFO - [FDE Batch] Output shape: (657, 4096)
2025-10-17 16:09:30,690 - INFO - [FDE Batch] Partition counter keys: 657 documents
2025-10-17 16:09:31,097 - INFO - [MEMORY] After atomic batch 26: 1784.0 MB (1.74 GB)
2025-10-17 16:09:31,178 - INFO - [Atomic Batch] Completed processing 25657 documents
2025-10-17 16:09:31,178 - INFO - [Atomic Batch] FDE index saved to: /home/hyunji/Desktop/muvera_optimized/cache_muvera/scidocs/fde_index_3_4.mmap
2025-10-17 16:09:31,178 - INFO - [MEMORY] After atomic batch processing: 1784.0 MB (1.74 GB)
2025-10-17 16:09:31,178 - INFO - [ColbertFdeRetriever] Memory cleanup completed
2025-10-17 16:09:31,178 - INFO - [MEMORY] After memory cleanup: 1784.0 MB (1.74 GB)
2025-10-17 16:09:31,409 - INFO - [ColbertFdeRetriever] Saved FDE index cache to: /home/hyunji/Desktop/muvera_optimized/cache_muvera/scidocs
2025-10-17 16:09:31,410 - INFO - [MEMORY] Index completed: 1784.0 MB (1.74 GB)
2025-10-17 16:09:31,412 - INFO - '2. ColBERT + FDE (+Chamfer rerank)' indexing finished in 228.38 seconds.
2025-10-17 16:09:31,412 - INFO - --- PHASE 2: SEARCH & EVALUATION ---
2025-10-17 16:09:31,412 - INFO - Running search for '2. ColBERT + FDE (+Chamfer rerank)' on 1000 queries...
ColBERT queries embeddings:   0%|          | 0/1 [00:00<?, ?it/s]ColBERT queries embeddings: 100%|██████████| 1/1 [00:00<00:00, 128.21it/s]
Traceback (most recent call last):
  File "/home/hyunji/Desktop/muvera_optimized/build_batch_fde.py", line 606, in <module>
    retriever.precompute_queries(queries)
  File "/home/hyunji/Desktop/muvera_optimized/build_batch_fde.py", line 461, in precompute_queries
    query_fde = generate_query_fde(query_embeddings, query_config)
TypeError: generate_query_fde() missing 1 required positional argument: 'query_or_doc'
[2025-10-17 16:09:31] FAILED P=3 R=4
